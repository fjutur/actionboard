<!DOCTYPE HTML>
<html lang='de'>
<head>
   <meta http-equiv='Content-Type' content='text/html; charset=utf-8' >
   <meta name='format-detection' content='telephone=no'>

   <title>Actionboard</title>
   
            <link rel='stylesheet' href='styles.css' type='text/css' />
            <script src='jquery-ui/js/jquery-1.7.1.min.js' type='text/javascript'></script>
            <script src='jquery-ui/js/jquery-ui-1.8.18.custom.min.js' type='text/javascript'></script>
            <script src='jquery-ui/js/jquery.ui.touch-punch.js' type='text/javascript'></script>

            <script type="text/javascript">
function init(){
  return [{name:""}];
}    

function create(project){
  if (project.name === undefined) project.name = "";

  $project = $("<div class='project'></div>");
  $project.append($("<textarea class='name' placeholder='Project Name'>"+ project.name +"</textarea>"));
  $("body").append($project);

  $project.find('textarea').keyup(function(e) {
    save();
  });

  $project.keydown(function(e) {
    console.log(e.which);
    if (e.which == 46){
      $project.fadeOut(300,function(){
        $(this).remove();
        save();
      });      
    }
  });
}

function save(){
  var projects = [];
  $(".project").each(function(i){
    var p = { name: $(this).find('.name').val() }
    projects.push(p);
    console.log("saving " + p.name);      
  });
  localStorage.setItem('projects', JSON.stringify(projects, null, 2));
}

function load(){
  var projects = JSON.parse(localStorage.getItem('projects'));
  if (projects === null) projects = init();

  $.each(projects, function(i,p){
    create(p);
  });
};

$(document).ready(function() {

  load();
  
});

</script>

</head>

<body>
  <div class="toolbar">
    <a href="javascript:void(0)" onclick="create({}); save();">New Project</a>
  </div>

</body>
</html>

